{"ast":null,"code":"const handleSubmit = async e => {\n  e.preventDefault();\n  if (!validateForm()) {\n    return;\n  }\n  setSubmitting(true);\n  setError('');\n  try {\n    // Get user ID from localStorage\n    const userStr = localStorage.getItem('user');\n    let userId = null;\n    if (userStr) {\n      var _userData$user, _userData$user2;\n      const userData = JSON.parse(userStr);\n      // Checking both common structures: userData.id or userData.user.id\n      userId = ((_userData$user = userData.user) === null || _userData$user === void 0 ? void 0 : _userData$user.user_id) || ((_userData$user2 = userData.user) === null || _userData$user2 === void 0 ? void 0 : _userData$user2.id) || userData.id;\n    }\n    if (!userId) {\n      throw new Error(\"User session not found. Please log in again.\");\n    }\n    console.log('üíæ Submitting booking for user:', userId);\n    const bookingData = {\n      user_id: userId,\n      artwork_id: artwork.artwork_id,\n      customer_name: formData.fullName,\n      email: formData.email,\n      phone: formData.phone,\n      preferred_date: formData.bookingDate,\n      preferred_time: formData.bookingTime,\n      delivery_address: `${formData.address}${formData.city ? ', ' + formData.city : ''}`,\n      special_instructions: formData.notes,\n      total_amount: Number(artwork.price) // Ensure it is a number\n    };\n    const response = await bookingAPI.createBooking(bookingData);\n    if (response.data) {\n      setSuccess(true);\n      setTimeout(() => {\n        navigate('/my-bookings');\n      }, 2000);\n    }\n  } catch (err) {\n    var _err$response, _err$response$data;\n    console.error('‚ùå Booking error:', err);\n    const errorMessage = ((_err$response = err.response) === null || _err$response === void 0 ? void 0 : (_err$response$data = _err$response.data) === null || _err$response$data === void 0 ? void 0 : _err$response$data.message) || err.message || 'Failed to submit booking';\n    setError(errorMessage);\n    setSubmitting(false);\n  }\n};","map":{"version":3,"names":["handleSubmit","e","preventDefault","validateForm","setSubmitting","setError","userStr","localStorage","getItem","userId","_userData$user","_userData$user2","userData","JSON","parse","user","user_id","id","Error","console","log","bookingData","artwork_id","artwork","customer_name","formData","fullName","email","phone","preferred_date","bookingDate","preferred_time","bookingTime","delivery_address","address","city","special_instructions","notes","total_amount","Number","price","response","bookingAPI","createBooking","data","setSuccess","setTimeout","navigate","err","_err$response","_err$response$data","error","errorMessage","message"],"sources":["D:/WALL ARTS/frontend/src/components/Booking/Booking.js"],"sourcesContent":["const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    \r\n    if (!validateForm()) {\r\n      return;\r\n    }\r\n\r\n    setSubmitting(true);\r\n    setError('');\r\n\r\n    try {\r\n      // Get user ID from localStorage\r\n      const userStr = localStorage.getItem('user');\r\n      let userId = null;\r\n      if (userStr) {\r\n        const userData = JSON.parse(userStr);\r\n        // Checking both common structures: userData.id or userData.user.id\r\n        userId = userData.user?.user_id || userData.user?.id || userData.id;\r\n      }\r\n\r\n      if (!userId) {\r\n        throw new Error(\"User session not found. Please log in again.\");\r\n      }\r\n\r\n      console.log('üíæ Submitting booking for user:', userId);\r\n\r\n      const bookingData = {\r\n        user_id: userId,\r\n        artwork_id: artwork.artwork_id,\r\n        customer_name: formData.fullName,\r\n        email: formData.email,\r\n        phone: formData.phone,\r\n        preferred_date: formData.bookingDate,\r\n        preferred_time: formData.bookingTime,\r\n        delivery_address: `${formData.address}${formData.city ? ', ' + formData.city : ''}`,\r\n        special_instructions: formData.notes,\r\n        total_amount: Number(artwork.price) // Ensure it is a number\r\n      };\r\n\r\n      const response = await bookingAPI.createBooking(bookingData);\r\n      \r\n      if (response.data) {\r\n        setSuccess(true);\r\n        setTimeout(() => {\r\n          navigate('/my-bookings');\r\n        }, 2000);\r\n      }\r\n    } catch (err) {\r\n      console.error('‚ùå Booking error:', err);\r\n      const errorMessage = err.response?.data?.message || err.message || 'Failed to submit booking';\r\n      setError(errorMessage);\r\n      setSubmitting(false);\r\n    }\r\n  };"],"mappings":"AAAA,MAAMA,YAAY,GAAG,MAAOC,CAAC,IAAK;EAC9BA,CAAC,CAACC,cAAc,CAAC,CAAC;EAElB,IAAI,CAACC,YAAY,CAAC,CAAC,EAAE;IACnB;EACF;EAEAC,aAAa,CAAC,IAAI,CAAC;EACnBC,QAAQ,CAAC,EAAE,CAAC;EAEZ,IAAI;IACF;IACA,MAAMC,OAAO,GAAGC,YAAY,CAACC,OAAO,CAAC,MAAM,CAAC;IAC5C,IAAIC,MAAM,GAAG,IAAI;IACjB,IAAIH,OAAO,EAAE;MAAA,IAAAI,cAAA,EAAAC,eAAA;MACX,MAAMC,QAAQ,GAAGC,IAAI,CAACC,KAAK,CAACR,OAAO,CAAC;MACpC;MACAG,MAAM,GAAG,EAAAC,cAAA,GAAAE,QAAQ,CAACG,IAAI,cAAAL,cAAA,uBAAbA,cAAA,CAAeM,OAAO,OAAAL,eAAA,GAAIC,QAAQ,CAACG,IAAI,cAAAJ,eAAA,uBAAbA,eAAA,CAAeM,EAAE,KAAIL,QAAQ,CAACK,EAAE;IACrE;IAEA,IAAI,CAACR,MAAM,EAAE;MACX,MAAM,IAAIS,KAAK,CAAC,8CAA8C,CAAC;IACjE;IAEAC,OAAO,CAACC,GAAG,CAAC,iCAAiC,EAAEX,MAAM,CAAC;IAEtD,MAAMY,WAAW,GAAG;MAClBL,OAAO,EAAEP,MAAM;MACfa,UAAU,EAAEC,OAAO,CAACD,UAAU;MAC9BE,aAAa,EAAEC,QAAQ,CAACC,QAAQ;MAChCC,KAAK,EAAEF,QAAQ,CAACE,KAAK;MACrBC,KAAK,EAAEH,QAAQ,CAACG,KAAK;MACrBC,cAAc,EAAEJ,QAAQ,CAACK,WAAW;MACpCC,cAAc,EAAEN,QAAQ,CAACO,WAAW;MACpCC,gBAAgB,EAAE,GAAGR,QAAQ,CAACS,OAAO,GAAGT,QAAQ,CAACU,IAAI,GAAG,IAAI,GAAGV,QAAQ,CAACU,IAAI,GAAG,EAAE,EAAE;MACnFC,oBAAoB,EAAEX,QAAQ,CAACY,KAAK;MACpCC,YAAY,EAAEC,MAAM,CAAChB,OAAO,CAACiB,KAAK,CAAC,CAAC;IACtC,CAAC;IAED,MAAMC,QAAQ,GAAG,MAAMC,UAAU,CAACC,aAAa,CAACtB,WAAW,CAAC;IAE5D,IAAIoB,QAAQ,CAACG,IAAI,EAAE;MACjBC,UAAU,CAAC,IAAI,CAAC;MAChBC,UAAU,CAAC,MAAM;QACfC,QAAQ,CAAC,cAAc,CAAC;MAC1B,CAAC,EAAE,IAAI,CAAC;IACV;EACF,CAAC,CAAC,OAAOC,GAAG,EAAE;IAAA,IAAAC,aAAA,EAAAC,kBAAA;IACZ/B,OAAO,CAACgC,KAAK,CAAC,kBAAkB,EAAEH,GAAG,CAAC;IACtC,MAAMI,YAAY,GAAG,EAAAH,aAAA,GAAAD,GAAG,CAACP,QAAQ,cAAAQ,aAAA,wBAAAC,kBAAA,GAAZD,aAAA,CAAcL,IAAI,cAAAM,kBAAA,uBAAlBA,kBAAA,CAAoBG,OAAO,KAAIL,GAAG,CAACK,OAAO,IAAI,0BAA0B;IAC7FhD,QAAQ,CAAC+C,YAAY,CAAC;IACtBhD,aAAa,CAAC,KAAK,CAAC;EACtB;AACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}