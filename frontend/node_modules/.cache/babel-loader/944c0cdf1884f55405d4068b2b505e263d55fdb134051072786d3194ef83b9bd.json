{"ast":null,"code":"// backend/models/Booking.js\n\nconst pool = require('../config/database');\nclass Booking {\n  static async create(data) {\n    try {\n      console.log('üíæ BOOKING MODEL - CREATE METHOD');\n      console.log('üì• Data received:', data);\n      const query = `\n        INSERT INTO bookings (\n          user_id, artwork_id, customer_name, email, phone, \n          preferred_date, preferred_time, delivery_address, \n          special_instructions, total_amount, status\n        ) VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11)\n        RETURNING booking_id\n      `;\n      const values = [data.user_id, data.artwork_id, data.customer_name, data.email, data.phone, data.preferred_date, data.preferred_time, data.delivery_address, data.special_instructions || null, data.total_amount, 'pending'];\n      console.log('üìù SQL Query:', query);\n      console.log('üìù SQL Values:', values);\n      const result = await pool.query(query, values);\n      console.log('‚úÖ SQL Result:', result.rows);\n      console.log('‚úÖ Booking ID:', result.rows[0].booking_id);\n      return result.rows[0].booking_id;\n    } catch (error) {\n      console.error('‚ùå BOOKING MODEL - SQL Insert Error:', error.message);\n      console.error('‚ùå Full error:', error);\n      throw error;\n    }\n  }\n  static async getByUser(userId) {\n    try {\n      console.log('üîç BOOKING MODEL - GET BY USER METHOD');\n      console.log('üë§ User ID:', userId);\n      const query = `\n        SELECT \n          b.*,\n          a.title AS artwork_title, \n          a.image_url,\n          ar.artist_name\n        FROM bookings b\n        LEFT JOIN artworks a ON b.artwork_id = a.artwork_id\n        LEFT JOIN artists ar ON a.artist_id = ar.artist_id\n        WHERE b.user_id = $1\n        ORDER BY b.created_at DESC\n      `;\n      console.log('üìù SQL Query:', query);\n      console.log('üìù SQL Value:', [userId]);\n      const result = await pool.query(query, [userId]);\n      console.log('‚úÖ SQL Result rows count:', result.rows.length);\n      console.log('‚úÖ Bookings found:', result.rows);\n      return result.rows;\n    } catch (error) {\n      console.error('‚ùå BOOKING MODEL - SQL Fetch Error:', error.message);\n      console.error('‚ùå Full error:', error);\n      throw error;\n    }\n  }\n\n  // ‚≠ê NEW METHOD - GET ALL BOOKINGS (ADMIN ONLY)\n  static async getAllBookings() {\n    try {\n      console.log('üëë BOOKING MODEL - GET ALL BOOKINGS METHOD (ADMIN)');\n      const query = `\n        SELECT \n          b.*,\n          a.title AS artwork_title, \n          a.image_url,\n          ar.artist_name,\n          u.username,\n          u.email AS user_email\n        FROM bookings b\n        LEFT JOIN artworks a ON b.artwork_id = a.artwork_id\n        LEFT JOIN artists ar ON a.artist_id = ar.artist_id\n        LEFT JOIN users u ON b.user_id = u.user_id\n        ORDER BY b.created_at DESC\n      `;\n      console.log('üìù SQL Query:', query);\n      const result = await pool.query(query);\n      console.log('‚úÖ Total bookings found:', result.rows.length);\n      return result.rows;\n    } catch (error) {\n      console.error('‚ùå BOOKING MODEL - SQL Fetch Error:', error.message);\n      console.error('‚ùå Full error:', error);\n      throw error;\n    }\n  }\n}\nmodule.exports = Booking;","map":{"version":3,"names":["pool","require","Booking","create","data","console","log","query","values","user_id","artwork_id","customer_name","email","phone","preferred_date","preferred_time","delivery_address","special_instructions","total_amount","result","rows","booking_id","error","message","getByUser","userId","length","getAllBookings","module","exports"],"sources":["D:/WALL ARTS/frontend/src/components/Booking/Booking.js"],"sourcesContent":["// backend/models/Booking.js\r\n\r\nconst pool = require('../config/database');\r\n\r\nclass Booking {\r\n  static async create(data) {\r\n    try {\r\n      console.log('üíæ BOOKING MODEL - CREATE METHOD');\r\n      console.log('üì• Data received:', data);\r\n      \r\n      const query = `\r\n        INSERT INTO bookings (\r\n          user_id, artwork_id, customer_name, email, phone, \r\n          preferred_date, preferred_time, delivery_address, \r\n          special_instructions, total_amount, status\r\n        ) VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11)\r\n        RETURNING booking_id\r\n      `;\r\n      \r\n      const values = [\r\n        data.user_id,\r\n        data.artwork_id,\r\n        data.customer_name,\r\n        data.email,\r\n        data.phone,\r\n        data.preferred_date,\r\n        data.preferred_time,\r\n        data.delivery_address,\r\n        data.special_instructions || null,\r\n        data.total_amount,\r\n        'pending'\r\n      ];\r\n\r\n      console.log('üìù SQL Query:', query);\r\n      console.log('üìù SQL Values:', values);\r\n\r\n      const result = await pool.query(query, values);\r\n      \r\n      console.log('‚úÖ SQL Result:', result.rows);\r\n      console.log('‚úÖ Booking ID:', result.rows[0].booking_id);\r\n      \r\n      return result.rows[0].booking_id;\r\n    } catch (error) {\r\n      console.error('‚ùå BOOKING MODEL - SQL Insert Error:', error.message);\r\n      console.error('‚ùå Full error:', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  static async getByUser(userId) {\r\n    try {\r\n      console.log('üîç BOOKING MODEL - GET BY USER METHOD');\r\n      console.log('üë§ User ID:', userId);\r\n      \r\n      const query = `\r\n        SELECT \r\n          b.*,\r\n          a.title AS artwork_title, \r\n          a.image_url,\r\n          ar.artist_name\r\n        FROM bookings b\r\n        LEFT JOIN artworks a ON b.artwork_id = a.artwork_id\r\n        LEFT JOIN artists ar ON a.artist_id = ar.artist_id\r\n        WHERE b.user_id = $1\r\n        ORDER BY b.created_at DESC\r\n      `;\r\n      \r\n      console.log('üìù SQL Query:', query);\r\n      console.log('üìù SQL Value:', [userId]);\r\n      \r\n      const result = await pool.query(query, [userId]);\r\n      \r\n      console.log('‚úÖ SQL Result rows count:', result.rows.length);\r\n      console.log('‚úÖ Bookings found:', result.rows);\r\n      \r\n      return result.rows;\r\n    } catch (error) {\r\n      console.error('‚ùå BOOKING MODEL - SQL Fetch Error:', error.message);\r\n      console.error('‚ùå Full error:', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  // ‚≠ê NEW METHOD - GET ALL BOOKINGS (ADMIN ONLY)\r\n  static async getAllBookings() {\r\n    try {\r\n      console.log('üëë BOOKING MODEL - GET ALL BOOKINGS METHOD (ADMIN)');\r\n      \r\n      const query = `\r\n        SELECT \r\n          b.*,\r\n          a.title AS artwork_title, \r\n          a.image_url,\r\n          ar.artist_name,\r\n          u.username,\r\n          u.email AS user_email\r\n        FROM bookings b\r\n        LEFT JOIN artworks a ON b.artwork_id = a.artwork_id\r\n        LEFT JOIN artists ar ON a.artist_id = ar.artist_id\r\n        LEFT JOIN users u ON b.user_id = u.user_id\r\n        ORDER BY b.created_at DESC\r\n      `;\r\n      \r\n      console.log('üìù SQL Query:', query);\r\n      \r\n      const result = await pool.query(query);\r\n      \r\n      console.log('‚úÖ Total bookings found:', result.rows.length);\r\n      \r\n      return result.rows;\r\n    } catch (error) {\r\n      console.error('‚ùå BOOKING MODEL - SQL Fetch Error:', error.message);\r\n      console.error('‚ùå Full error:', error);\r\n      throw error;\r\n    }\r\n  }\r\n}\r\n\r\nmodule.exports = Booking;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}